{% extends "../core/document.html" %}

{% comment ******************* %}
{% comment Emit navigation     %}
{% comment ******************* %}
{% block doc-nav %}
    <li><a href="#{{ doc.ext.full_id }}-overview">Overview</a></li>
	{% if doc.responsible_parties %}
	    <li><a href="#{{ doc.ext.full_id }}-contacts">Responsible Parties</a></li>
    {% end %}
	{% if doc.inputs %}
	    <li><a href="#{{ doc.ext.full_id }}-inputs">Inputs ({{len(doc.inputs)}})</a></li>
    {% end %}
	{% if doc.model_reference and doc.model_reference.changes %}
	    <li><a href="#{{ doc.ext.full_id }}-model-mods">Model Modifications {{len(doc.model_reference.changes)}}</a></li>
	{% end %}
{% end %}

{% comment ***************** %}
{% comment Emit content      %}
{% comment ***************** %}
{% block doc-content %}

	{% comment ***************** %}
	{% comment Emit overview     %}
	{% comment ***************** %}
	{% set ctx = TemplateInfo(doc,
		header = "Overview",
		tag_id = doc.ext.full_id + "-overview",
		template = "cim_1_activity_simulation_run_overview.html"
	) %}
	{% include ../core/section_02.html %}

	{% comment ***************** %}
	{% comment Emit contacts     %}
	{% comment ***************** %}
	{% if doc.responsible_parties %}
		{% set contacts = doc.responsible_parties %}
		{% set header = "h3" %}
		{% set section_id = "{0}-contacts".format(doc.ext.full_id) %}
		{% include shared_responsible_party_1.html %}
    {% end %}

	{% comment ***************** %}
	{% comment Emit inputs   %}
	{% comment ***************** %}
	{% if doc.inputs %}
		{% set ctx = TemplateInfo(doc.inputs,
			tag_id = doc.ext.full_id + '-',
			header = "Couplings",
			template = "cim_1_activity_simulation_input.html"
		) %}
		{% include ../core/section_02.html %}
	{% end %}

	{% comment ***************** %}
	{% comment Emit model mods   %}
	{% comment ***************** %}
	{% if doc.model_reference and len(doc.model_reference.changes) %}
		{% set changeset = [c for c in doc.model_reference.changes if len(c.details)] %}
		{% if len(changeset) %}


		{% set ctx = TemplateInfo(doc,
			fieldset_type = "property",
			header = "Model Modifications",
			tag_id = doc.ext.full_id + "-model-mods",
			template = "fieldset_table.html"
		) %}
		{% for change_property in changeset %}
			{% raw ctx.fieldset.append(FieldInfo(change_property.name, value=change_property.details[0].description)) or "" %}
		{% end %}
		{% include ../core/section_01.html %}

		{% end %}
	{% end %}

{% end %}